# CGLIB动态代理类代码分析
## 注意事项
1. Spring 使用CGLIB创建代理对象时，是不会执行父类的构造函数的
     - 由源代码 org.springframework.aop.framework.DefaultAopProxyFactory.createAopProxy 可以得知，创建CGLIB代理对象时是使用： org.springframework.aop.framework.ObjenesisCglibAopProxy，ObjenesisCglibAopProxy使用了SpringObjenesis来创建实例，该方式在创建实例时是不会调用super()方法的
## 总结
+ JDK动态代理和CGLIB动态代理都会且仅会生成一个代理类，在这个代理类中，会将所有的advice收集，并形成一个执行链，再依次执行这个执行链。具体的代码分别在JdkDynamicAopProxy和CglibAopProxy
## 背景
+ 知其然，知其所以然
## CGLIB动态代理的本质
- CGLIB动态代理不是通过Java的反射机制实现的，那是通过什么机制实现的呢? 见: 02-4. MethodProxy代码
## 代码分析
### 01. .java源文件
+ 不实现任何接口，使Spring在创建代理对象的时候使用CGLIB。
```java
package com.imooc.services.impl;

import com.imooc.services.WelcomeService;
import org.springframework.stereotype.Service;

@Service
public class WelcomeServiceImpl /*implements WelcomeService*/ {
	/*@Override*/
	public String sayHello(String name) {
		System.out.println("SayHello: " + name);
		return "Success";
	}
}
```
### 02. CGLIB动态代理生成的.class文件
+ 每一个被代理类，CGLIB动态代理都会为之生成了3个.class文件
    1. WelcomeServiceImpl\\$\\$EnhancerBySpringCGLIB\\$\\$d24c71.class 即 代理类Class文件
    2. WelcomeServiceImpl\\$\\$EnhancerBySpringCGLIB\\$\\$d24c71$$FastClassBySpringCGLIB\\$\\$85bf5ee3.class,即代理类对应的FastClass文件
    3. WelcomeServiceImpl\\$\\$FastClassBySpringCGLIB\\$\\$93e5dd0d.class,即被代理类对应的FastClass文件
#### 02-1. WelcomeServiceImpl\\$\\$EnhancerBySpringCGLIB\\$\\$d24c71.class 即代理类.class文件
```java
package com.imooc.services.impl;

import org.springframework.cglib.proxy.*;
import java.lang.reflect.*;
import org.springframework.cglib.core.*;
import org.aopalliance.aop.*;
import org.springframework.aop.framework.*;
import org.springframework.aop.*;

/**
 * CGLIB动态代理类是直接集成被代理类的，因此
 *    1. 若被代理类是final的，则无法被代理了 
 */
public class WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71 extends WelcomeServiceImpl implements SpringProxy, Advised, Factory
{
    private boolean CGLIB$BOUND;
    public static Object CGLIB$FACTORY_DATA;
    private static final ThreadLocal CGLIB$THREAD_CALLBACKS;

    // 如构造函数，CGLIB是允许多个CallBack的：org.springframework.cglib.proxy.Enhancer#create(java.lang.Class, java.lang.Class[], org.springframework.cglib.proxy.CallbackFilter, org.springframework.cglib.proxy.Callback[])
    private static final Callback[] CGLIB$STATIC_CALLBACKS;
    
    // 其实这个属性的类型就是:org.springframework.aop.framework.CglibAopProxy.DynamicAdvisedInterceptor,具体的参考代理创建过程
    private MethodInterceptor CGLIB$CALLBACK_0;
    private MethodInterceptor CGLIB$CALLBACK_1;

    private NoOp CGLIB$CALLBACK_2;

    private Dispatcher CGLIB$CALLBACK_3;
    private Dispatcher CGLIB$CALLBACK_4;
    
    private MethodInterceptor CGLIB$CALLBACK_5;
    private MethodInterceptor CGLIB$CALLBACK_6;

    private static Object CGLIB$CALLBACK_FILTER;

    private static final Method CGLIB$sayHello$0$Method;
    private static final MethodProxy CGLIB$sayHello$0$Proxy;
    private static final Object[] CGLIB$emptyArgs;
    private static final Method CGLIB$equals$1$Method;
    private static final MethodProxy CGLIB$equals$1$Proxy;
    private static final Method CGLIB$toString$2$Method;
    private static final MethodProxy CGLIB$toString$2$Proxy;
    private static final Method CGLIB$hashCode$3$Method;
    private static final MethodProxy CGLIB$hashCode$3$Proxy;
    private static final Method CGLIB$clone$4$Method;
    private static final MethodProxy CGLIB$clone$4$Proxy;
    
    static void CGLIB$STATICHOOK5() {
        CGLIB$THREAD_CALLBACKS = new ThreadLocal();
        CGLIB$emptyArgs = new Object[0];
        
        /**
          * 可以看出，如下的代码其实都是将被代理类的对应方法(equals,toString,hashCode,clone,sayHello方法)通过反射的方式
          * 将方法入口作为该代理类的静态属性，并且为每个方法都创建一个MethodProxy类型的实例。
          *
          */
        final Class<?> forName = Class.forName("com.imooc.services.impl.WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71");
        final Class<?> forName2;

        final Method[] methods = ReflectUtils.findMethods(new String[] { "equals", "(Ljava/lang/Object;)Z", "toString", "()Ljava/lang/String;", "hashCode", "()I", "clone", "()Ljava/lang/Object;" }, (forName2 = Class.forName("java.lang.Object")).getDeclaredMethods());

        // equals方法
        CGLIB$equals$1$Method = methods[0];
        CGLIB$equals$1$Proxy = MethodProxy.create((Class)forName2, (Class)forName, "(Ljava/lang/Object;)Z", "equals", "CGLIB$equals$1");
        
        // toString方法 
        CGLIB$toString$2$Method = methods[1];
        CGLIB$toString$2$Proxy = MethodProxy.create((Class)forName2, (Class)forName, "()Ljava/lang/String;", "toString", "CGLIB$toString$2");

        // hashCode方法
        CGLIB$hashCode$3$Method = methods[2];
        CGLIB$hashCode$3$Proxy = MethodProxy.create((Class)forName2, (Class)forName, "()I", "hashCode", "CGLIB$hashCode$3");

        // clone方法
        CGLIB$clone$4$Method = methods[3];
        CGLIB$clone$4$Proxy = MethodProxy.create((Class)forName2, (Class)forName, "()Ljava/lang/Object;", "clone", "CGLIB$clone$4");

        final Class<?> forName3;
        // sayHello方法
        // 从代码可以看出，CGLIB$sayHello$0$Method 这个Method类型的属性是com.imooc.services.impl.WelcomeServiceImpl类中的sayHello方法,即:被代理类的方法
        CGLIB$sayHello$0$Method = ReflectUtils.findMethods(new String[] { "sayHello", "(Ljava/lang/String;)Ljava/lang/String;" }, (forName3 = Class.forName("com.imooc.services.impl.WelcomeServiceImpl")).getDeclaredMethods())[0];
        // 从代码可以看出，该属性的类型是MethodProxy,其代理的是sayHello(com.imooc.services.impl.WelcomeServiceImpl#sayHello)方法
        CGLIB$sayHello$0$Proxy = MethodProxy.create((Class)forName3, (Class)forName, "(Ljava/lang/String;)Ljava/lang/String;", "sayHello", "CGLIB$sayHello$0");
    }
    
    // 为什么这里会有这个方法: 见  02-4. MethodProxy代码
    final String CGLIB$sayHello$0(final String s) {
        return super.sayHello(s);
    }
    
    public final String sayHello(final String s) {
        try {
            MethodInterceptor cglib$CALLBACK_2;
            MethodInterceptor cglib$CALLBACK_0;
            if ((cglib$CALLBACK_0 = (cglib$CALLBACK_2 = this.CGLIB$CALLBACK_0)) == null) {
                CGLIB$BIND_CALLBACKS(this);
                cglib$CALLBACK_2 = (cglib$CALLBACK_0 = this.CGLIB$CALLBACK_0);
            }
            /* 当MethodInterceptor存在的时候，则调用其intercept方法，参数依次为: 代理对象，正在执行的方法(被代理类的方法),方法参数,代理方法 (怎么知道的呢? Debug+打断点)
             * 并且，在MethodInterceptor中，只能调用代理方法的invokeSuper方法methodProxy.invokeSuper(o, args);或者methodProxy.invoke(o,args);,因为只有这样才能使用到FastClass机制
             *
             *
             * 
             *  这里为什么可以实现多个切面方法？请参考:org.springframework.aop.framework.CglibAopProxy.DynamicAdvisedInterceptor,这是一个内部类,
             * 实现了：org.springframework.cglib.proxy.MethodInterceptor接口并重写了intercept方法，而实现多个切面的逻辑就是在这里
             */
            
            if (cglib$CALLBACK_0 != null) {
                return (String)cglib$CALLBACK_2.intercept((Object)this, WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$sayHello$0$Method, new Object[] { s }, WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$sayHello$0$Proxy);
            }
            return super.sayHello(s);
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    final boolean CGLIB$equals$1(final Object o) {
        return super.equals(o);
    }
    
    public final boolean equals(final Object o) {
        try {
            MethodInterceptor cglib$CALLBACK_6;
            MethodInterceptor cglib$CALLBACK_5;
            if ((cglib$CALLBACK_5 = (cglib$CALLBACK_6 = this.CGLIB$CALLBACK_5)) == null) {
                CGLIB$BIND_CALLBACKS(this);
                cglib$CALLBACK_6 = (cglib$CALLBACK_5 = this.CGLIB$CALLBACK_5);
            }
            if (cglib$CALLBACK_5 != null) {
                final Object intercept = cglib$CALLBACK_6.intercept((Object)this, WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$equals$1$Method, new Object[] { o }, WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$equals$1$Proxy);
                return intercept != null && (boolean)intercept;
            }
            return super.equals(o);
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    final String CGLIB$toString$2() {
        return super.toString();
    }
    
    public final String toString() {
        try {
            MethodInterceptor cglib$CALLBACK_2;
            MethodInterceptor cglib$CALLBACK_0;
            if ((cglib$CALLBACK_0 = (cglib$CALLBACK_2 = this.CGLIB$CALLBACK_0)) == null) {
                CGLIB$BIND_CALLBACKS(this);
                cglib$CALLBACK_2 = (cglib$CALLBACK_0 = this.CGLIB$CALLBACK_0);
            }
            if (cglib$CALLBACK_0 != null) {
                return (String)cglib$CALLBACK_2.intercept((Object)this, WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$toString$2$Method, WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$emptyArgs, WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$toString$2$Proxy);
            }
            return super.toString();
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    final int CGLIB$hashCode$3() {
        return super.hashCode();
    }
    
    public final int hashCode() {
        try {
            MethodInterceptor cglib$CALLBACK_7;
            MethodInterceptor cglib$CALLBACK_6;
            if ((cglib$CALLBACK_6 = (cglib$CALLBACK_7 = this.CGLIB$CALLBACK_6)) == null) {
                CGLIB$BIND_CALLBACKS(this);
                cglib$CALLBACK_7 = (cglib$CALLBACK_6 = this.CGLIB$CALLBACK_6);
            }
            if (cglib$CALLBACK_6 != null) {
                final Object intercept = cglib$CALLBACK_7.intercept((Object)this, WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$hashCode$3$Method, WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$emptyArgs, WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$hashCode$3$Proxy);
                return (intercept == null) ? 0 : ((Number)intercept).intValue();
            }
            return super.hashCode();
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    final Object CGLIB$clone$4() throws CloneNotSupportedException {
        return super.clone();
    }
    
    protected final Object clone() throws CloneNotSupportedException {
        try {
            MethodInterceptor cglib$CALLBACK_2;
            MethodInterceptor cglib$CALLBACK_0;
            if ((cglib$CALLBACK_0 = (cglib$CALLBACK_2 = this.CGLIB$CALLBACK_0)) == null) {
                CGLIB$BIND_CALLBACKS(this);
                cglib$CALLBACK_2 = (cglib$CALLBACK_0 = this.CGLIB$CALLBACK_0);
            }
            if (cglib$CALLBACK_0 != null) {
                return cglib$CALLBACK_2.intercept((Object)this, WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$clone$4$Method, WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$emptyArgs, WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$clone$4$Proxy);
            }
            return super.clone();
        }
        catch (RuntimeException | Error | CloneNotSupportedException ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public static MethodProxy CGLIB$findMethodProxy(final Signature signature) {
        final String string = signature.toString();
        switch (string.hashCode()) {
            case -1816210712: {
                if (string.equals("sayHello(Ljava/lang/String;)Ljava/lang/String;")) {
                    return WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$sayHello$0$Proxy;
                }
                break;
            }
            case -508378822: {
                if (string.equals("clone()Ljava/lang/Object;")) {
                    return WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$clone$4$Proxy;
                }
                break;
            }
            case 1826985398: {
                if (string.equals("equals(Ljava/lang/Object;)Z")) {
                    return WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$equals$1$Proxy;
                }
                break;
            }
            case 1913648695: {
                if (string.equals("toString()Ljava/lang/String;")) {
                    return WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$toString$2$Proxy;
                }
                break;
            }
            case 1984935277: {
                if (string.equals("hashCode()I")) {
                    return WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$hashCode$3$Proxy;
                }
                break;
            }
        }
        return null;
    }
    
    public final int indexOf(final Advisor advisor) {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            return ((Advised)dispatcher.loadObject()).indexOf(advisor);
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public final int indexOf(final Advice advice) {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            return ((Advised)dispatcher.loadObject()).indexOf(advice);
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public final boolean isFrozen() {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            return ((Advised)dispatcher.loadObject()).isFrozen();
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public final void setTargetSource(final TargetSource targetSource) {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            ((Advised)dispatcher.loadObject()).setTargetSource(targetSource);
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public final TargetSource getTargetSource() {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            return ((Advised)dispatcher.loadObject()).getTargetSource();
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public final void setExposeProxy(final boolean exposeProxy) {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            ((Advised)dispatcher.loadObject()).setExposeProxy(exposeProxy);
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public final boolean isExposeProxy() {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            return ((Advised)dispatcher.loadObject()).isExposeProxy();
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public final boolean isProxyTargetClass() {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            return ((Advised)dispatcher.loadObject()).isProxyTargetClass();
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public final void setPreFiltered(final boolean preFiltered) {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            ((Advised)dispatcher.loadObject()).setPreFiltered(preFiltered);
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public final Advisor[] getAdvisors() {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            return ((Advised)dispatcher.loadObject()).getAdvisors();
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public final void addAdvice(final int n, final Advice advice) throws AopConfigException {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            ((Advised)dispatcher.loadObject()).addAdvice(n, advice);
        }
        catch (RuntimeException | Error | AopConfigException ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public final void addAdvice(final Advice advice) throws AopConfigException {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            ((Advised)dispatcher.loadObject()).addAdvice(advice);
        }
        catch (RuntimeException | Error | AopConfigException ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public final boolean isPreFiltered() {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            return ((Advised)dispatcher.loadObject()).isPreFiltered();
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public final Class[] getProxiedInterfaces() {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            return ((Advised)dispatcher.loadObject()).getProxiedInterfaces();
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public final boolean isInterfaceProxied(final Class clazz) {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            return ((Advised)dispatcher.loadObject()).isInterfaceProxied(clazz);
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public final void addAdvisor(final int n, final Advisor advisor) throws AopConfigException {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            ((Advised)dispatcher.loadObject()).addAdvisor(n, advisor);
        }
        catch (RuntimeException | Error | AopConfigException ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public final void addAdvisor(final Advisor advisor) throws AopConfigException {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            ((Advised)dispatcher.loadObject()).addAdvisor(advisor);
        }
        catch (RuntimeException | Error | AopConfigException ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public final void removeAdvisor(final int n) throws AopConfigException {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            ((Advised)dispatcher.loadObject()).removeAdvisor(n);
        }
        catch (RuntimeException | Error | AopConfigException ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public final boolean removeAdvisor(final Advisor advisor) {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            return ((Advised)dispatcher.loadObject()).removeAdvisor(advisor);
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public final boolean replaceAdvisor(final Advisor advisor, final Advisor advisor2) throws AopConfigException {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            return ((Advised)dispatcher.loadObject()).replaceAdvisor(advisor, advisor2);
        }
        catch (RuntimeException | Error | AopConfigException ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public final boolean removeAdvice(final Advice advice) {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            return ((Advised)dispatcher.loadObject()).removeAdvice(advice);
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public final String toProxyConfigString() {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            return ((Advised)dispatcher.loadObject()).toProxyConfigString();
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public final Class getTargetClass() {
        try {
            Dispatcher dispatcher;
            if ((dispatcher = this.CGLIB$CALLBACK_4) == null) {
                CGLIB$BIND_CALLBACKS(this);
                dispatcher = this.CGLIB$CALLBACK_4;
            }
            return ((TargetClassAware)dispatcher.loadObject()).getTargetClass();
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71() {
        try {
            CGLIB$BIND_CALLBACKS(this);
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public static void CGLIB$SET_THREAD_CALLBACKS(final Callback[] array) {
        WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$THREAD_CALLBACKS.set(array);
    }
    
    public static void CGLIB$SET_STATIC_CALLBACKS(final Callback[] cglib$STATIC_CALLBACKS) {
        CGLIB$STATIC_CALLBACKS = cglib$STATIC_CALLBACKS;
    }
    
    private static final void CGLIB$BIND_CALLBACKS(final Object o) {
        final WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71 welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71 = (WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71)o;
        if (!welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$BOUND) {
            welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$BOUND = true;
            Callback[] array;
            if ((array = WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$THREAD_CALLBACKS.get()) != null || (array = WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$STATIC_CALLBACKS) != null) {
                final Callback[] array2 = array;
                final WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71 welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c72 = welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71;
                welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c72.CGLIB$CALLBACK_6 = (MethodInterceptor)array2[6];
                welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c72.CGLIB$CALLBACK_5 = (MethodInterceptor)array2[5];
                welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c72.CGLIB$CALLBACK_4 = (Dispatcher)array2[4];
                welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c72.CGLIB$CALLBACK_3 = (Dispatcher)array2[3];
                welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c72.CGLIB$CALLBACK_2 = (NoOp)array2[2];
                welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c72.CGLIB$CALLBACK_1 = (MethodInterceptor)array2[1];
                welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c72.CGLIB$CALLBACK_0 = (MethodInterceptor)array2[0];
            }
        }
    }
    
    public Object newInstance(final Callback[] array) {
        try {
            CGLIB$SET_THREAD_CALLBACKS(array);
            final WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71 welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71 = new WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71();
            CGLIB$SET_THREAD_CALLBACKS(null);
            return welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71;
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public Object newInstance(final Callback callback) {
        try {
            throw new IllegalStateException("More than one callback object required");
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public Object newInstance(final Class[] array, final Object[] array2, final Callback[] array3) {
        try {
            CGLIB$SET_THREAD_CALLBACKS(array3);
            switch (array.length) {
                case 0: {
                    final WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71 welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71 = new WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71();
                    CGLIB$SET_THREAD_CALLBACKS(null);
                    return welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71;
                }
                default: {
                    throw new IllegalArgumentException("Constructor not found");
                }
            }
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public Callback getCallback(final int n) {
        try {
            CGLIB$BIND_CALLBACKS(this);
            Object o = null;
            switch (n) {
                case 0: {
                    o = this.CGLIB$CALLBACK_0;
                    break;
                }
                case 1: {
                    o = this.CGLIB$CALLBACK_1;
                    break;
                }
                case 2: {
                    o = this.CGLIB$CALLBACK_2;
                    break;
                }
                case 3: {
                    o = this.CGLIB$CALLBACK_3;
                    break;
                }
                case 4: {
                    o = this.CGLIB$CALLBACK_4;
                    break;
                }
                case 5: {
                    o = this.CGLIB$CALLBACK_5;
                    break;
                }
                case 6: {
                    o = this.CGLIB$CALLBACK_6;
                    break;
                }
                default: {
                    o = null;
                    break;
                }
            }
            return (Callback)o;
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public void setCallback(final int n, final Callback callback) {
        try {
            switch (n) {
                case 0: {
                    this.CGLIB$CALLBACK_0 = (MethodInterceptor)callback;
                    break;
                }
                case 1: {
                    this.CGLIB$CALLBACK_1 = (MethodInterceptor)callback;
                    break;
                }
                case 2: {
                    this.CGLIB$CALLBACK_2 = (NoOp)callback;
                    break;
                }
                case 3: {
                    this.CGLIB$CALLBACK_3 = (Dispatcher)callback;
                    break;
                }
                case 4: {
                    this.CGLIB$CALLBACK_4 = (Dispatcher)callback;
                    break;
                }
                case 5: {
                    this.CGLIB$CALLBACK_5 = (MethodInterceptor)callback;
                    break;
                }
                case 6: {
                    this.CGLIB$CALLBACK_6 = (MethodInterceptor)callback;
                    break;
                }
            }
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public Callback[] getCallbacks() {
        try {
            CGLIB$BIND_CALLBACKS(this);
            return new Callback[] { (Callback)this.CGLIB$CALLBACK_0, (Callback)this.CGLIB$CALLBACK_1, (Callback)this.CGLIB$CALLBACK_2, (Callback)this.CGLIB$CALLBACK_3, (Callback)this.CGLIB$CALLBACK_4, (Callback)this.CGLIB$CALLBACK_5, (Callback)this.CGLIB$CALLBACK_6 };
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public void setCallbacks(final Callback[] array) {
        try {
            this.CGLIB$CALLBACK_0 = (MethodInterceptor)array[0];
            this.CGLIB$CALLBACK_1 = (MethodInterceptor)array[1];
            this.CGLIB$CALLBACK_2 = (NoOp)array[2];
            this.CGLIB$CALLBACK_3 = (Dispatcher)array[3];
            this.CGLIB$CALLBACK_4 = (Dispatcher)array[4];
            this.CGLIB$CALLBACK_5 = (MethodInterceptor)array[5];
            this.CGLIB$CALLBACK_6 = (MethodInterceptor)array[6];
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    static {
        CGLIB$STATICHOOK6();
        CGLIB$STATICHOOK5();
    }
    
    static void CGLIB$STATICHOOK6() {
    }
}
```
#### 02-2. WelcomeServiceImpl\\$\\$EnhancerBySpringCGLIB\\$\\$d24c71\\$\\$FastClassBySpringCGLIB\\$\\$85bf5ee3.class 代理类的FastClass
+ 从MethodProxy的代码可以得出： 该类会在MethodProxy.invokeSuper的时候被调用
```java
package com.imooc.services.impl;

import org.springframework.cglib.reflect.*;
import org.springframework.cglib.core.*;
import org.aopalliance.aop.*;
import org.springframework.cglib.proxy.*;
import org.springframework.aop.*;
import java.lang.reflect.*;

public class WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71$$FastClassBySpringCGLIB$$85bf5ee3 extends FastClass
{
    public WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71$$FastClassBySpringCGLIB$$85bf5ee3(final Class clazz) {
        try {
            super(clazz);
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public int getIndex(final Signature signature) {
        try {
            final String string = signature.toString();
            switch (string.hashCode()) {
                case -2103996935: {
                    if (string.equals("isExposeProxy()Z")) {
                        return 15;
                    }
                    break;
                }
                case -1938347695: {
                    if (string.equals("getTargetClass()Ljava/lang/Class;")) {
                        return 11;
                    }
                    break;
                }
                case -1891827894: {
                    if (string.equals("getProxiedInterfaces()[Ljava/lang/Class;")) {
                        return 29;
                    }
                    break;
                }
                case -1887170608: {
                    if (string.equals("getTargetSource()Lorg/springframework/aop/TargetSource;")) {
                        return 13;
                    }
                    break;
                }
                case -1882565338: {
                    if (string.equals("CGLIB$equals$1(Ljava/lang/Object;)Z")) {
                        return 41;
                    }
                    break;
                }
                case -1870561232: {
                    if (string.equals("CGLIB$findMethodProxy(Lorg/springframework/cglib/core/Signature;)Lorg/springframework/cglib/proxy/MethodProxy;")) {
                        return 25;
                    }
                    break;
                }
                case -1816210712: {
                    if (string.equals("sayHello(Ljava/lang/String;)Ljava/lang/String;")) {
                        return 10;
                    }
                    break;
                }
                case -1745842178: {
                    if (string.equals("setCallbacks([Lorg/springframework/cglib/proxy/Callback;)V")) {
                        return 20;
                    }
                    break;
                }
                case -1656914424: {
                    if (string.equals("indexOf(Lorg/aopalliance/aop/Advice;)I")) {
                        return 4;
                    }
                    break;
                }
                case -1641413109: {
                    if (string.equals("newInstance([Lorg/springframework/cglib/proxy/Callback;)Ljava/lang/Object;")) {
                        return 7;
                    }
                    break;
                }
                case -1457416524: {
                    if (string.equals("CGLIB$STATICHOOK5()V")) {
                        return 40;
                    }
                    break;
                }
                case -1457386733: {
                    if (string.equals("CGLIB$STATICHOOK6()V")) {
                        return 43;
                    }
                    break;
                }
                case -1411842725: {
                    if (string.equals("CGLIB$hashCode$3()I")) {
                        return 39;
                    }
                    break;
                }
                case -1378580207: {
                    if (string.equals("toProxyConfigString()Ljava/lang/String;")) {
                        return 37;
                    }
                    break;
                }
                case -1127359161: {
                    if (string.equals("setExposeProxy(Z)V")) {
                        return 14;
                    }
                    break;
                }
                case -1068101097: {
                    if (string.equals("setPreFiltered(Z)V")) {
                        return 17;
                    }
                    break;
                }
                case -1034266769: {
                    if (string.equals("CGLIB$SET_STATIC_CALLBACKS([Lorg/springframework/cglib/proxy/Callback;)V")) {
                        return 22;
                    }
                    break;
                }
                case -1025895669: {
                    if (string.equals("CGLIB$SET_THREAD_CALLBACKS([Lorg/springframework/cglib/proxy/Callback;)V")) {
                        return 21;
                    }
                    break;
                }
                case -1012917840: {
                    if (string.equals("addAdvice(ILorg/aopalliance/aop/Advice;)V")) {
                        return 26;
                    }
                    break;
                }
                case -1006102474: {
                    if (string.equals("isProxyTargetClass()Z")) {
                        return 16;
                    }
                    break;
                }
                case -988317324: {
                    if (string.equals("newInstance([Ljava/lang/Class;[Ljava/lang/Object;[Lorg/springframework/cglib/proxy/Callback;)Ljava/lang/Object;")) {
                        return 6;
                    }
                    break;
                }
                case -980141523: {
                    if (string.equals("replaceAdvisor(Lorg/springframework/aop/Advisor;Lorg/springframework/aop/Advisor;)Z")) {
                        return 35;
                    }
                    break;
                }
                case -904152374: {
                    if (string.equals("removeAdvisor(I)V")) {
                        return 33;
                    }
                    break;
                }
                case -872603166: {
                    if (string.equals("removeAdvisor(Lorg/springframework/aop/Advisor;)Z")) {
                        return 34;
                    }
                    break;
                }
                case -552893142: {
                    if (string.equals("addAdvisor(ILorg/springframework/aop/Advisor;)V")) {
                        return 32;
                    }
                    break;
                }
                case -508378822: {
                    if (string.equals("clone()Ljava/lang/Object;")) {
                        return 3;
                    }
                    break;
                }
                case -439517399: {
                    if (string.equals("isPreFiltered()Z")) {
                        return 28;
                    }
                    break;
                }
                case 187947380: {
                    if (string.equals("setTargetSource(Lorg/springframework/aop/TargetSource;)V")) {
                        return 12;
                    }
                    break;
                }
                case 610042816: {
                    if (string.equals("newInstance(Lorg/springframework/cglib/proxy/Callback;)Ljava/lang/Object;")) {
                        return 8;
                    }
                    break;
                }
                case 644726458: {
                    if (string.equals("isInterfaceProxied(Ljava/lang/Class;)Z")) {
                        return 30;
                    }
                    break;
                }
                case 1132856532: {
                    if (string.equals("getCallbacks()[Lorg/springframework/cglib/proxy/Callback;")) {
                        return 24;
                    }
                    break;
                }
                case 1238545150: {
                    if (string.equals("indexOf(Lorg/springframework/aop/Advisor;)I")) {
                        return 5;
                    }
                    break;
                }
                case 1246779367: {
                    if (string.equals("setCallback(ILorg/springframework/cglib/proxy/Callback;)V")) {
                        return 19;
                    }
                    break;
                }
                case 1298742135: {
                    if (string.equals("CGLIB$sayHello$0(Ljava/lang/String;)Ljava/lang/String;")) {
                        return 44;
                    }
                    break;
                }
                case 1306468936: {
                    if (string.equals("CGLIB$toString$2()Ljava/lang/String;")) {
                        return 38;
                    }
                    break;
                }
                case 1364367423: {
                    if (string.equals("getCallback(I)Lorg/springframework/cglib/proxy/Callback;")) {
                        return 23;
                    }
                    break;
                }
                case 1426835813: {
                    if (string.equals("addAdvice(Lorg/aopalliance/aop/Advice;)V")) {
                        return 27;
                    }
                    break;
                }
                case 1636583119: {
                    if (string.equals("isFrozen()Z")) {
                        return 9;
                    }
                    break;
                }
                case 1744736673: {
                    if (string.equals("addAdvisor(Lorg/springframework/aop/Advisor;)V")) {
                        return 31;
                    }
                    break;
                }
                case 1800494055: {
                    if (string.equals("CGLIB$clone$4()Ljava/lang/Object;")) {
                        return 42;
                    }
                    break;
                }
                case 1826985398: {
                    if (string.equals("equals(Ljava/lang/Object;)Z")) {
                        return 0;
                    }
                    break;
                }
                case 1913648695: {
                    if (string.equals("toString()Ljava/lang/String;")) {
                        return 1;
                    }
                    break;
                }
                case 1984935277: {
                    if (string.equals("hashCode()I")) {
                        return 2;
                    }
                    break;
                }
                case 2119600998: {
                    if (string.equals("removeAdvice(Lorg/aopalliance/aop/Advice;)Z")) {
                        return 36;
                    }
                    break;
                }
                case 2122046924: {
                    if (string.equals("getAdvisors()[Lorg/springframework/aop/Advisor;")) {
                        return 18;
                    }
                    break;
                }
            }
            return -1;
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public int getIndex(final String s, final Class[] array) {
        try {
            Label_2285: {
                switch (s.hashCode()) {
                    case -2012993625: {
                        if (!s.equals("sayHello")) {
                            break;
                        }
                        switch (array.length) {
                            case 1: {
                                if (array[0].getName().equals("java.lang.String")) {
                                    return 10;
                                }
                                break Label_2285;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case -1983192202: {
                        if (!s.equals("CGLIB$sayHello$0")) {
                            break;
                        }
                        switch (array.length) {
                            case 1: {
                                if (array[0].getName().equals("java.lang.String")) {
                                    return 44;
                                }
                                break Label_2285;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case -1776922004: {
                        if (!s.equals("toString")) {
                            break;
                        }
                        switch (array.length) {
                            case 0: {
                                return 1;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case -1567161245: {
                        if (!s.equals("isProxyTargetClass")) {
                            break;
                        }
                        switch (array.length) {
                            case 0: {
                                return 16;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case -1383403876: {
                        if (!s.equals("removeAdvice")) {
                            break;
                        }
                        switch (array.length) {
                            case 1: {
                                if (array[0].getName().equals("org.aopalliance.aop.Advice")) {
                                    return 36;
                                }
                                break Label_2285;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case -1295482945: {
                        if (!s.equals("equals")) {
                            break;
                        }
                        switch (array.length) {
                            case 1: {
                                if (array[0].getName().equals("java.lang.Object")) {
                                    return 0;
                                }
                                break Label_2285;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case -1260627944: {
                        if (!s.equals("setPreFiltered")) {
                            break;
                        }
                        switch (array.length) {
                            case 1: {
                                if (array[0].getName().equals("boolean")) {
                                    return 17;
                                }
                                break Label_2285;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case -1137093050: {
                        if (!s.equals("toProxyConfigString")) {
                            break;
                        }
                        switch (array.length) {
                            case 0: {
                                return 37;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case -1053468136: {
                        if (!s.equals("getCallbacks")) {
                            break;
                        }
                        switch (array.length) {
                            case 0: {
                                return 24;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case -592051094: {
                        if (!s.equals("isFrozen")) {
                            break;
                        }
                        switch (array.length) {
                            case 0: {
                                return 9;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case -560688532: {
                        if (!s.equals("replaceAdvisor")) {
                            break;
                        }
                        switch (array.length) {
                            case 2: {
                                if (array[0].getName().equals("org.springframework.aop.Advisor") && array[1].getName().equals("org.springframework.aop.Advisor")) {
                                    return 35;
                                }
                                break Label_2285;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case -529128199: {
                        if (!s.equals("addAdvice")) {
                            break;
                        }
                        switch (array.length) {
                            case 1: {
                                if (array[0].getName().equals("org.aopalliance.aop.Advice")) {
                                    return 27;
                                }
                                break Label_2285;
                            }
                            case 2: {
                                if (array[0].getName().equals("int") && array[1].getName().equals("org.aopalliance.aop.Advice")) {
                                    return 26;
                                }
                                break Label_2285;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case -258655664: {
                        if (!s.equals("isPreFiltered")) {
                            break;
                        }
                        switch (array.length) {
                            case 0: {
                                return 28;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case -124978609: {
                        if (!s.equals("CGLIB$equals$1")) {
                            break;
                        }
                        switch (array.length) {
                            case 1: {
                                if (array[0].getName().equals("java.lang.Object")) {
                                    return 41;
                                }
                                break Label_2285;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case -60403779: {
                        if (!s.equals("CGLIB$SET_STATIC_CALLBACKS")) {
                            break;
                        }
                        switch (array.length) {
                            case 1: {
                                if (array[0].getName().equals("[Lorg.springframework.cglib.proxy.Callback;")) {
                                    return 22;
                                }
                                break Label_2285;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case -29025555: {
                        if (!s.equals("CGLIB$hashCode$3")) {
                            break;
                        }
                        switch (array.length) {
                            case 0: {
                                return 39;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 64168604: {
                        if (!s.equals("removeAdvisor")) {
                            break;
                        }
                        switch (array.length) {
                            case 1: {
                                final String name = array[0].getName();
                                switch (name.hashCode()) {
                                    case 104431: {
                                        if (name.equals("int")) {
                                            return 33;
                                        }
                                        break;
                                    }
                                    case 554907597: {
                                        if (name.equals("org.springframework.aop.Advisor")) {
                                            return 34;
                                        }
                                        break;
                                    }
                                }
                                break Label_2285;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 71818497: {
                        if (!s.equals("getProxiedInterfaces")) {
                            break;
                        }
                        switch (array.length) {
                            case 0: {
                                return 29;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 85179481: {
                        if (!s.equals("CGLIB$SET_THREAD_CALLBACKS")) {
                            break;
                        }
                        switch (array.length) {
                            case 1: {
                                if (array[0].getName().equals("[Lorg.springframework.cglib.proxy.Callback;")) {
                                    return 21;
                                }
                                break Label_2285;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 94756189: {
                        if (!s.equals("clone")) {
                            break;
                        }
                        switch (array.length) {
                            case 0: {
                                return 3;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 147696667: {
                        if (!s.equals("hashCode")) {
                            break;
                        }
                        switch (array.length) {
                            case 0: {
                                return 2;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 161998113: {
                        if (!s.equals("CGLIB$STATICHOOK5")) {
                            break;
                        }
                        switch (array.length) {
                            case 0: {
                                return 40;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 161998114: {
                        if (!s.equals("CGLIB$STATICHOOK6")) {
                            break;
                        }
                        switch (array.length) {
                            case 0: {
                                return 43;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 232340296: {
                        if (!s.equals("setExposeProxy")) {
                            break;
                        }
                        switch (array.length) {
                            case 1: {
                                if (array[0].getName().equals("boolean")) {
                                    return 14;
                                }
                                break Label_2285;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 495524492: {
                        if (!s.equals("setCallbacks")) {
                            break;
                        }
                        switch (array.length) {
                            case 1: {
                                if (array[0].getName().equals("[Lorg.springframework.cglib.proxy.Callback;")) {
                                    return 20;
                                }
                                break Label_2285;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 776910815: {
                        if (!s.equals("addAdvisor")) {
                            break;
                        }
                        switch (array.length) {
                            case 1: {
                                if (array[0].getName().equals("org.springframework.aop.Advisor")) {
                                    return 31;
                                }
                                break Label_2285;
                            }
                            case 2: {
                                if (array[0].getName().equals("int") && array[1].getName().equals("org.springframework.aop.Advisor")) {
                                    return 32;
                                }
                                break Label_2285;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 811662670: {
                        if (!s.equals("isInterfaceProxied")) {
                            break;
                        }
                        switch (array.length) {
                            case 1: {
                                if (array[0].getName().equals("java.lang.Class")) {
                                    return 30;
                                }
                                break Label_2285;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 1081419650: {
                        if (!s.equals("getTargetSource")) {
                            break;
                        }
                        switch (array.length) {
                            case 0: {
                                return 13;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 1154623345: {
                        if (!s.equals("CGLIB$findMethodProxy")) {
                            break;
                        }
                        switch (array.length) {
                            case 1: {
                                if (array[0].getName().equals("org.springframework.cglib.core.Signature")) {
                                    return 25;
                                }
                                break Label_2285;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 1234312576: {
                        if (!s.equals("isExposeProxy")) {
                            break;
                        }
                        switch (array.length) {
                            case 0: {
                                return 15;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 1366611497: {
                        if (!s.equals("getAdvisors")) {
                            break;
                        }
                        switch (array.length) {
                            case 0: {
                                return 18;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 1543336189: {
                        if (!s.equals("CGLIB$toString$2")) {
                            break;
                        }
                        switch (array.length) {
                            case 0: {
                                return 38;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 1544020273: {
                        if (!s.equals("getTargetClass")) {
                            break;
                        }
                        switch (array.length) {
                            case 0: {
                                return 11;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 1811874389: {
                        if (!s.equals("newInstance")) {
                            break;
                        }
                        switch (array.length) {
                            case 1: {
                                final String name2 = array[0].getName();
                                switch (name2.hashCode()) {
                                    case -1997738671: {
                                        if (name2.equals("[Lorg.springframework.cglib.proxy.Callback;")) {
                                            return 7;
                                        }
                                        break;
                                    }
                                    case 1364160985: {
                                        if (name2.equals("org.springframework.cglib.proxy.Callback")) {
                                            return 8;
                                        }
                                        break;
                                    }
                                }
                                break Label_2285;
                            }
                            case 3: {
                                if (array[0].getName().equals("[Ljava.lang.Class;") && array[1].getName().equals("[Ljava.lang.Object;") && array[2].getName().equals("[Lorg.springframework.cglib.proxy.Callback;")) {
                                    return 6;
                                }
                                break Label_2285;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 1817099975: {
                        if (!s.equals("setCallback")) {
                            break;
                        }
                        switch (array.length) {
                            case 2: {
                                if (array[0].getName().equals("int") && array[1].getName().equals("org.springframework.cglib.proxy.Callback")) {
                                    return 19;
                                }
                                break Label_2285;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 1905679803: {
                        if (!s.equals("getCallback")) {
                            break;
                        }
                        switch (array.length) {
                            case 1: {
                                if (array[0].getName().equals("int")) {
                                    return 23;
                                }
                                break Label_2285;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 1943291465: {
                        if (!s.equals("indexOf")) {
                            break;
                        }
                        switch (array.length) {
                            case 1: {
                                final String name3 = array[0].getName();
                                switch (name3.hashCode()) {
                                    case -201664093: {
                                        if (name3.equals("org.aopalliance.aop.Advice")) {
                                            return 4;
                                        }
                                        break;
                                    }
                                    case 554907597: {
                                        if (name3.equals("org.springframework.aop.Advisor")) {
                                            return 5;
                                        }
                                        break;
                                    }
                                }
                                break Label_2285;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 1951977610: {
                        if (!s.equals("CGLIB$clone$4")) {
                            break;
                        }
                        switch (array.length) {
                            case 0: {
                                return 42;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                    case 1992172174: {
                        if (!s.equals("setTargetSource")) {
                            break;
                        }
                        switch (array.length) {
                            case 1: {
                                if (array[0].getName().equals("org.springframework.aop.TargetSource")) {
                                    return 12;
                                }
                                break Label_2285;
                            }
                            default: {
                                break Label_2285;
                            }
                        }
                        break;
                    }
                }
            }
            return -1;
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public int getIndex(final Class[] array) {
        try {
            switch (array.length) {
                case 0: {
                    return 0;
                }
                default: {
                    return -1;
                }
            }
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
   // 通过如下代码可以发现，CGLIB调用方法并不是通过反射机制来实现的 
    public Object invoke(final int n, final Object o, final Object[] array) throws InvocationTargetException {
        try {
            final WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71 welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71 = (WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71)o;
            try {
                switch (n) {
                    case 0: {
                        return new Boolean(welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.equals(array[0]));
                    }
                    case 1: {
                        return welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.toString();
                    }
                    case 2: {
                        return new Integer(welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.hashCode());
                    }
                    case 3: {
                        return welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.clone();
                    }
                    case 4: {
                        return new Integer(welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.indexOf((Advice)array[0]));
                    }
                    case 5: {
                        return new Integer(welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.indexOf((Advisor)array[0]));
                    }
                    case 6: {
                        return welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.newInstance((Class[])array[0], (Object[])array[1], (Callback[])array[2]);
                    }
                    case 7: {
                        return welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.newInstance((Callback[])array[0]);
                    }
                    case 8: {
                        return welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.newInstance((Callback)array[0]);
                    }
                    case 9: {
                        return new Boolean(welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.isFrozen());
                    }
                    case 10: {
                        return welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.sayHello((String)array[0]);
                    }
                    case 11: {
                        return welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.getTargetClass();
                    }
                    case 12: {
                        welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.setTargetSource((TargetSource)array[0]);
                        return null;
                    }
                    case 13: {
                        return welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.getTargetSource();
                    }
                    case 14: {
                        welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.setExposeProxy((boolean)array[0]);
                        return null;
                    }
                    case 15: {
                        return new Boolean(welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.isExposeProxy());
                    }
                    case 16: {
                        return new Boolean(welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.isProxyTargetClass());
                    }
                    case 17: {
                        welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.setPreFiltered((boolean)array[0]);
                        return null;
                    }
                    case 18: {
                        return welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.getAdvisors();
                    }
                    case 19: {
                        welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.setCallback(((Number)array[0]).intValue(), (Callback)array[1]);
                        return null;
                    }
                    case 20: {
                        welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.setCallbacks((Callback[])array[0]);
                        return null;
                    }
                    case 21: {
                        WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$SET_THREAD_CALLBACKS((Callback[])array[0]);
                        return null;
                    }
                    case 22: {
                        WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$SET_STATIC_CALLBACKS((Callback[])array[0]);
                        return null;
                    }
                    case 23: {
                        return welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.getCallback(((Number)array[0]).intValue());
                    }
                    case 24: {
                        return welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.getCallbacks();
                    }
                    case 25: {
                        return WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$findMethodProxy((Signature)array[0]);
                    }
                    case 26: {
                        welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.addAdvice(((Number)array[0]).intValue(), (Advice)array[1]);
                        return null;
                    }
                    case 27: {
                        welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.addAdvice((Advice)array[0]);
                        return null;
                    }
                    case 28: {
                        return new Boolean(welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.isPreFiltered());
                    }
                    case 29: {
                        return welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.getProxiedInterfaces();
                    }
                    case 30: {
                        return new Boolean(welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.isInterfaceProxied((Class)array[0]));
                    }
                    case 31: {
                        welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.addAdvisor((Advisor)array[0]);
                        return null;
                    }
                    case 32: {
                        welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.addAdvisor(((Number)array[0]).intValue(), (Advisor)array[1]);
                        return null;
                    }
                    case 33: {
                        welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.removeAdvisor(((Number)array[0]).intValue());
                        return null;
                    }
                    case 34: {
                        return new Boolean(welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.removeAdvisor((Advisor)array[0]));
                    }
                    case 35: {
                        return new Boolean(welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.replaceAdvisor((Advisor)array[0], (Advisor)array[1]));
                    }
                    case 36: {
                        return new Boolean(welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.removeAdvice((Advice)array[0]));
                    }
                    case 37: {
                        return welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.toProxyConfigString();
                    }
                    case 38: {
                        return welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$toString$2();
                    }
                    case 39: {
                        return new Integer(welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$hashCode$3());
                    }
                    case 40: {
                        WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$STATICHOOK5();
                        return null;
                    }
                    case 41: {
                        return new Boolean(welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$equals$1(array[0]));
                    }
                    case 42: {
                        return welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$clone$4();
                    }
                    case 43: {
                        WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$STATICHOOK6();
                        return null;
                    }
                    case 44: {
                        return welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$sayHello$0((String)array[0]);
                    }
                }
            }
            catch (Throwable t) {
                throw new InvocationTargetException(t);
            }
            throw new IllegalArgumentException("Cannot find matching method/constructor");
        }
        catch (RuntimeException | Error | InvocationTargetException ex) {
            throw;
        }
        catch (Throwable t2) {
            throw new UndeclaredThrowableException(t2);
        }
    }
    
    public Object newInstance(final int n, final Object[] array) throws InvocationTargetException {
        try {
            try {
                switch (n) {
                    case 0: {
                        return new WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71();
                    }
                }
            }
            catch (Throwable t) {
                throw new InvocationTargetException(t);
            }
            throw new IllegalArgumentException("Cannot find matching method/constructor");
        }
        catch (RuntimeException | Error | InvocationTargetException ex) {
            throw;
        }
        catch (Throwable t2) {
            throw new UndeclaredThrowableException(t2);
        }
    }
    
    public int getMaxIndex() {
        try {
            return 44;
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
}

```
#### 02-2. WelcomeServiceImpl\\$\\$FastClassBySpringCGLIB\\$\\$93e5dd0d.class 被代理类的FastClass
+ 由MethodProxy的代码可以看出，该FastClass会在MethodProxy.invoke方法中被使用
```java
package com.imooc.services.impl;

import org.springframework.cglib.reflect.*;
import org.springframework.cglib.core.*;
import java.lang.reflect.*;

public class WelcomeServiceImpl$$FastClassBySpringCGLIB$$93e5dd0d extends FastClass
{
    public WelcomeServiceImpl$$FastClassBySpringCGLIB$$93e5dd0d(final Class clazz) {
        try {
            super(clazz);
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public int getIndex(final Signature signature) {
        try {
            final String string = signature.toString();
            switch (string.hashCode()) {
                case -1816210712: {
                    if (string.equals("sayHello(Ljava/lang/String;)Ljava/lang/String;")) {
                        return 0;
                    }
                    break;
                }
                case 1826985398: {
                    if (string.equals("equals(Ljava/lang/Object;)Z")) {
                        return 1;
                    }
                    break;
                }
                case 1913648695: {
                    if (string.equals("toString()Ljava/lang/String;")) {
                        return 2;
                    }
                    break;
                }
                case 1984935277: {
                    if (string.equals("hashCode()I")) {
                        return 3;
                    }
                    break;
                }
            }
            return -1;
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public int getIndex(final String s, final Class[] array) {
        try {
            Label_0218: {
                switch (s.hashCode()) {
                    case -2012993625: {
                        if (!s.equals("sayHello")) {
                            break;
                        }
                        switch (array.length) {
                            case 1: {
                                if (array[0].getName().equals("java.lang.String")) {
                                    return 0;
                                }
                                break Label_0218;
                            }
                            default: {
                                break Label_0218;
                            }
                        }
                        break;
                    }
                    case -1776922004: {
                        if (!s.equals("toString")) {
                            break;
                        }
                        switch (array.length) {
                            case 0: {
                                return 2;
                            }
                            default: {
                                break Label_0218;
                            }
                        }
                        break;
                    }
                    case -1295482945: {
                        if (!s.equals("equals")) {
                            break;
                        }
                        switch (array.length) {
                            case 1: {
                                if (array[0].getName().equals("java.lang.Object")) {
                                    return 1;
                                }
                                break Label_0218;
                            }
                            default: {
                                break Label_0218;
                            }
                        }
                        break;
                    }
                    case 147696667: {
                        if (!s.equals("hashCode")) {
                            break;
                        }
                        switch (array.length) {
                            case 0: {
                                return 3;
                            }
                            default: {
                                break Label_0218;
                            }
                        }
                        break;
                    }
                }
            }
            return -1;
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
    
    public int getIndex(final Class[] array) {
        try {
            switch (array.length) {
                case 0: {
                    return 0;
                }
                default: {
                    return -1;
                }
            }
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
   
    // 通过代码可以发现，CGLIB调用被代理对象的方法并不是通过反射来实现的
    public Object invoke(final int n, final Object o, final Object[] array) throws InvocationTargetException {
        try {
            final WelcomeServiceImpl welcomeServiceImpl = (WelcomeServiceImpl)o;
            try {
                switch (n) {
                    case 0: {
                        return welcomeServiceImpl.sayHello((String)array[0]);
                    }
                    case 1: {
                        return new Boolean(welcomeServiceImpl.equals(array[0]));
                    }
                    case 2: {
                        return welcomeServiceImpl.toString();
                    }
                    case 3: {
                        return new Integer(welcomeServiceImpl.hashCode());
                    }
                }
            }
            catch (Throwable t) {
                throw new InvocationTargetException(t);
            }
            throw new IllegalArgumentException("Cannot find matching method/constructor");
        }
        catch (RuntimeException | Error | InvocationTargetException ex) {
            throw;
        }
        catch (Throwable t2) {
            throw new UndeclaredThrowableException(t2);
        }
    }
    
    public Object newInstance(final int n, final Object[] array) throws InvocationTargetException {
        try {
            try {
                switch (n) {
                    case 0: {
                        return new WelcomeServiceImpl();
                    }
                }
            }
            catch (Throwable t) {
                throw new InvocationTargetException(t);
            }
            throw new IllegalArgumentException("Cannot find matching method/constructor");
        }
        catch (RuntimeException | Error | InvocationTargetException ex) {
            throw;
        }
        catch (Throwable t2) {
            throw new UndeclaredThrowableException(t2);
        }
    }
    
    public int getMaxIndex() {
        try {
            return 3;
        }
        catch (RuntimeException | Error ex) {
            throw;
        }
        catch (Throwable t) {
            throw new UndeclaredThrowableException(t);
        }
    }
}

```
### 02-4. MethodProxy代码
+ 不论是MethodProxy中的invoke方法被调用还是invokeSuper方法被调用，其实开始调用的地方都是代理类的对应的方法，只不过是MethodInterceptor中调用的选择不一致（对比com.imooc.proxy.cglibproxy.StuMethodInterceptor和org.springframework.aop.framework.CglibAopProxy.DynamicAdvisedInterceptor.intercept就知道是什么意思了）。
+ 问题: 为什么调用MethodInterceptor的时候，不会栈溢出?
   - 因为调用路径如下:
       1. 调用代理类的sayHello方法
       2. 通过反编译的Class文件可以看出，代理类的sayHello方法中调用了MethodInterceptor的intercept方法
       3. 在第二步的intercept方法中调用了invokeSuper方法
       4. invokeSuper方法又调用了代理类的方法（间接调用代理类的方法,MethodProxy.invokeSuper调用的是代理类的FastClass的invoke方法，然后代理类FastClass再去调用代理类的对应方法），请注意，此时就不是调用的代理类的sayHello方法了，而是代理类中的CGLIB$sayHello$0方法(可通过打断点的方式观察)
            - 即在这个例子中，fci.i2是44而不是10(验证方式: 将代理类保存到文件系统，通过断点获取fci.i2的值，再去代理类中查找)
       5. 因为这样的逻辑，就不会互相调用而导致栈溢出了
+ Jdk动态代理是通过反射实现的，而CGLIB是通过FastClass来实现的
   - 通过反编译FastClass文件可以看出，CGLIB动态代理类调用被代理对象的方法是直接通过对象来调用的，而不是反射。（通过索引方法，再由被代理类直接调用方法，而不是通过反射）
```java
package org.springframework.cglib.proxy;

import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import org.springframework.cglib.core.AbstractClassGenerator;
import org.springframework.cglib.core.CodeGenerationException;
import org.springframework.cglib.core.GeneratorStrategy;
import org.springframework.cglib.core.NamingPolicy;
import org.springframework.cglib.core.Signature;
import org.springframework.cglib.reflect.FastClass;
import org.springframework.cglib.reflect.FastClass.Generator;

public class MethodProxy {
    private Signature sig1;
    private Signature sig2;
    private MethodProxy.CreateInfo createInfo;
    private final Object initLock = new Object();
    /*
     * FastClass
     * 
     * FastClassInfo.f1 是被代理类的FastClass
     * FastClassInfo.f2 是代理类的FastClass
     */
    private volatile MethodProxy.FastClassInfo fastClassInfo;

    public static MethodProxy create(Class c1, Class c2, String desc, String name1, String name2) {
        MethodProxy proxy = new MethodProxy();
        proxy.sig1 = new Signature(name1, desc);
        proxy.sig2 = new Signature(name2, desc);
        // 生成FastClass
        proxy.createInfo = new MethodProxy.CreateInfo(c1, c2);
        return proxy;
    }

    private void init() {
        if (this.fastClassInfo == null) {
            synchronized(this.initLock) {
                if (this.fastClassInfo == null) {
                    MethodProxy.CreateInfo ci = this.createInfo;
                    MethodProxy.FastClassInfo fci = new MethodProxy.FastClassInfo();
                    fci.f1 = helper(ci, ci.c1);
                    fci.f2 = helper(ci, ci.c2);
                    fci.i1 = fci.f1.getIndex(this.sig1);
                    fci.i2 = fci.f2.getIndex(this.sig2);
                    this.fastClassInfo = fci;
                    this.createInfo = null;
                }
            }
        }

    }

    private static FastClass helper(MethodProxy.CreateInfo ci, Class type) {
        Generator g = new Generator();
        g.setType(type);
        g.setClassLoader(ci.c2.getClassLoader());
        g.setNamingPolicy(ci.namingPolicy);
        g.setStrategy(ci.strategy);
        g.setAttemptLoad(ci.attemptLoad);
        return g.create();
    }

    private MethodProxy() {
    }

    public Signature getSignature() {
        return this.sig1;
    }

    public String getSuperName() {
        return this.sig2.getName();
    }

    public int getSuperIndex() {
        this.init();
        return this.fastClassInfo.i2;
    }

    FastClass getFastClass() {
        this.init();
        return this.fastClassInfo.f1;
    }

    FastClass getSuperFastClass() {
        this.init();
        return this.fastClassInfo.f2;
    }

    public static MethodProxy find(Class type, Signature sig) {
        try {
            Method m = type.getDeclaredMethod("CGLIB$findMethodProxy", MethodInterceptorGenerator.FIND_PROXY_TYPES);
            return (MethodProxy)m.invoke((Object)null, sig);
        } catch (NoSuchMethodException var3) {
            throw new IllegalArgumentException("Class " + type + " does not use a MethodInterceptor");
        } catch (IllegalAccessException var4) {
            throw new CodeGenerationException(var4);
        } catch (InvocationTargetException var5) {
            throw new CodeGenerationException(var5);
        }
    }
    /**
      * obj： 被代理对象实例,即: obj.getClass(): com.imooc.services.impl.WelcomeServiceImpl 
      * args: 方法参数

      * 通过反编译过的FastClass可以看出,fci.f1.invoke 就是调用的是被代理类对应的FastClass的方法
      *
      */
    public Object invoke(Object obj, Object[] args) throws Throwable {
        try {
            this.init();
            MethodProxy.FastClassInfo fci = this.fastClassInfo;
            return fci.f1.invoke(fci.i1, obj, args);
        } catch (InvocationTargetException var4) {
            throw var4.getTargetException();
        } catch (IllegalArgumentException var5) {
            if (this.fastClassInfo.i1 < 0) {
                throw new IllegalArgumentException("Protected method: " + this.sig1);
            } else {
                throw var5;
            }
        }
    }

    /**
      * obj： 此时是代理对象实例,即: obj.getClass():  com.imooc.proxy.cglibproxy.WelcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.class
      * args: 方法参数

      * 通过反编译过的FastClass可以看出,fci.f2.invoke 就是调用的是代理类的FastClass方法。
      * 这里需要注意的是 fci.i2这个索引值，到底是谁的索引值，在这里，是welcomeServiceImpl$$EnhancerBySpringCGLIB$$d24c71.CGLIB$sayHello$0((String)array[0]);,
      * 通过class文件可以看出，这个方法只是对被代理类进行包装了一层，防止重复调用而导致StackOverFlow
      */
    public Object invokeSuper(Object obj, Object[] args) throws Throwable {
        try {
            this.init();
            MethodProxy.FastClassInfo fci = this.fastClassInfo;
            // obj即代理类对象，在fastClass的invoke方法中会进行强制类型转换，具体请看对应的FastClass
            return fci.f2.invoke(fci.i2, obj, args);
        } catch (InvocationTargetException var4) {
            throw var4.getTargetException();
        }
    }

    private static class CreateInfo {
        Class c1;
        Class c2;
        NamingPolicy namingPolicy;
        GeneratorStrategy strategy;
        boolean attemptLoad;

        public CreateInfo(Class c1, Class c2) {
            this.c1 = c1;
            this.c2 = c2;
            AbstractClassGenerator fromEnhancer = AbstractClassGenerator.getCurrent();
            if (fromEnhancer != null) {
                this.namingPolicy = fromEnhancer.getNamingPolicy();
                this.strategy = fromEnhancer.getStrategy();
                this.attemptLoad = fromEnhancer.getAttemptLoad();
            }

        }
    }

    private static class FastClassInfo {
        FastClass f1;
        FastClass f2;
        // 索引值
        int i1;
        // 索引值,可以通过org.springframework.cglib.reflect.FastClass#invoke(int, java.lang.Object, java.lang.Object[])方法进行分析
        int i2;

        private FastClassInfo() {
        }
    }
}
```
