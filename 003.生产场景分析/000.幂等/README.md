# 幂等
幂等是一个数学概念，用在接口上可以理解为： 同一个接口，多次发出同一个请求，请求的结果是一致的。

## 怎么保证接口的幂等性
1. token机制
   + 在请求之前，先获取唯一的token,再带着这个token去完成业务操作，服务端根据这个业务是否存在来判断请求是否是重复请求。
2. 分布式锁
3. 状态机
   + 有些业务表是有状态的，可以通过限制状态的流转来实现幂等。
4. 加数据库锁
   + 乐观锁 or 悲观锁
5. 加唯一索引
   + 插入重复数据时报错,针对于异常进行处理。
6. insert前先校验
   + insert前先select，如果数据存在，则直接返回；若数据不存在，则执行insert操作。
7. 建防重表
   + 有些业务场景才有用，例如：消息消费场景，可以将消息ID存下来，消费前通过消息ID查询消息是否消费过。